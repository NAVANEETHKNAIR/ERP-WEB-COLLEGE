<%--     Document   : fchat    Created on : Jul 27, 2017, 4:19:43 AM    Author     : rashid ahmad--%><%@page import="java.sql.*"%><%@page import="java.time.format.DateTimeFormatter"%><%@page import="java.time.LocalDate"%><!DOCTYPE html><%    String fid=(String)session.getAttribute("fid");    String fname=(String)session.getAttribute("fname");    if(fid==null && fname==null)      {        session.setAttribute("msg","Please Login First!!");        response.sendRedirect("index.jsp");    } %> <html>	<head>				<!-- Website Title & Description for Search Engine purposes -->		<title></title>		<meta name="description" content="">				<!-- Mobile viewport optimized -->		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">				<!-- Bootstrap CSS -->		<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">		<link href="bootstrap/css/bootstrap-glyphicons.css" rel="stylesheet">    <link href="DataTables/datatables.min.css" rel="stylesheet"/>  		<link href="includes/css/jquery.multiselect.css" rel="stylesheet" type="text/css">				<!-- Custom CSS -->		<link href="includes/css/styles.css" rel="stylesheet">				<!-- Include Modernizr in the head, before any other Javascript -->		<script src="includes/js/modernizr-2.6.2.min.js"></script>			</head>	<body>		<div class="bg">    	<div class="header">            <div class="container  text-center">                <a class="logo-hyper" href="faculty.jsp"><b>Skyline ERP</b></a>            </div>        </div>        <div class="container ">        	<div class="row">            	<div class="menu col-md-12 ">                	<div class="menu1 pull-left">                    	<a href='fchat.jsp'>Chat</a> &nbsp;&nbsp;&nbsp;&nbsp;                        <a href='supload.jsp'>Student Uploads</a>&nbsp;&nbsp;&nbsp;&nbsp;                        <a href='faculty.jsp'>Notice</a>&nbsp;&nbsp;&nbsp;&nbsp;                        <a href='index.jsp'>Logout</a>                    </div>                    <div class="menu1 pull-right">                    	<p>Welcome &nbsp;&nbsp; <b><%=fname%></b></p>                    </div>                </div>            </div>            <%                String msg=(String)session.getAttribute("msg");                if(msg!=null)                  {            %>                <div class="panel panel-primary">                    <div class="panel-heading text-center">                        <p><%=msg%></p>                    </div>                </div>                <%                    session.setAttribute("msg", null);                    }                %>        	<div class="notice-table col-md-8 pull-left">                  <h4 class="text-center">Faculty Chat</h4><hr/>                  <%                  PreparedStatement getChat=(PreparedStatement)application.getAttribute("getChat");                    getChat.setString(1, fid);                    getChat.setString(2, fname);                ResultSet crs=getChat.executeQuery();                while(crs.next())                {String n="";                    PreparedStatement getFaculty=(PreparedStatement)application.getAttribute("getFaculty");    getFaculty.setString(1, crs.getString(2));    ResultSet rs2=getFaculty.executeQuery();    if(rs2.next()){        n=rs2.getString(2);    }    PreparedStatement getStudent2=(PreparedStatement)application.getAttribute("getStudent");    getStudent2.setString(1, crs.getString(2));    ResultSet rs3=getStudent2.executeQuery();    if(rs3.next()){        n=rs3.getString(2);    }                %>                Sender : <b><%=n%></b> Date: <b><%=crs.getString(5)%></b><br/>                Message: <b><%=crs.getString(4)%></b><br/><hr/>                <%                    }                  %>                </div>                <div class=" col-sm-4 pull-right">                	<div class="box">                    	<h5 class="text-center"> New Chat</h5>                        <br>                        <form action="ChatPro.jsp"  method="post" data-toggle="validator" class="form-horizontal" role="form">              			<input type="hidden" name="sid" value="<%=fid%>"/>	                            <div class="form-group">                                <div class="col-sm-10 col-sm-offset-1">                                  <input type="text" class="form-control" name="m" placeholder="Message" required>                                </div>                            </div>                            <div class="form-group">                                <div class="col-sm-10 col-sm-offset-1">                                	<select name="r" multiple class="form-control" required>				<%                                    PreparedStatement getFacultyCourse=(PreparedStatement)application.getAttribute("getFacultyCourse");                                    getFacultyCourse.setString(1, fid);                                    ResultSet rs1=getFacultyCourse.executeQuery();                                    int x=0;                                    while(rs1.next())                                    {                                        String c=rs1.getString(2);                                        PreparedStatement getStuByCourse=(PreparedStatement)application.getAttribute("getStuByCourse");                                        getStuByCourse.setString(1, c);                                        ResultSet rs2=getStuByCourse.executeQuery();                                        while(rs2.next())                                    {                                %>                                                                      <option value="<%=++x+"."+rs2.getString(2)%>"><%=rs2.getString(2)%></option>                                <%                                    }                                    }                                %>                                    </select>                                                             	</div>                            </div>                                                        <div class="form-group">                                 <div class="col-sm-offset-1 col-sm-10">                                  <button type="submit" class="btn btn-primary">Submit</button>                                </div>                            </div>                        </form>                    </div>                </div>            </div>                    </div>        <div class="footer">            <div class="container text-center">                Design & Develop By RASHID AHMAD, FAROOQ ANSARI, HARSHITA MISHRA            </div>        </div>    </div>	  <script type="text/javascript" src="js/jquery-2.2.2.min.js"></script>  <script src="DataTables/datatables.min.js"></script>  <script src="bootstrap/js/bootstrap.min.js"></script>  <script src="includes/js/validator.js"></script>  <script src="includes/js/jquery.multiselect.js"></script>    <script type="text/javascript">      $(document).ready(function() {      $('#mydata').dataTable();    });    $('select[multiple]').multiselect({        columns: 2,        placeholder: 'Select'    });  </script>		</body></html>